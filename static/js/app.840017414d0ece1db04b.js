webpackJsonp([7],{NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("7+uW"),i=s("zL8q"),o=s.n(i),c=(s("tvR6"),s("ky1F"),s("mvHQ")),a=s.n(c),r=s("NYxO"),u={name:"App",data:function(){return{asideWidth:200,asideLeft:120,selectInfo:"全部网站数据",showSelect:!1,showUserOperation:!1,chooseH:!0,chooseA:!1,chooseC:!1,chooseM:!1}},computed:Object(r.b)(["user","websites","currentWebsite"]),methods:{asideAdjustClick:function(){this.asideWidth>100?(this.asideWidth=5,this.asideLeft=5):(this.asideWidth=200,this.asideLeft=120)},addNotification:function(t,e){var s=this.$createElement;this.$notify({title:t,message:s("i",{style:"color: teal"},e)})},logout:function(){this.showUserOperation=!1,this.showSelect=!1,this.$router.replace("/login"),this.selectInfo="全部网站数据",this.$store.commit("clearUser")},getUser:function(){this.$store.dispatch("getUser").then(function(){}).catch(function(){})},getWebsites:function(){var t=this;this.$store.dispatch("getWebsites").then(function(){t.loadSessionStorage()}).catch(function(){})},loadSessionStorage:function(){var t=JSON.parse(sessionStorage.getItem("website"));t?this.$store.commit("setCurrentWebsite",t):this.websites&&0!==this.websites.length&&this.$store.commit("setCurrentWebsite",this.websites[0]),sessionStorage.removeItem("website")},toggleSelect:function(){this.showSelect=!this.showSelect},toggleUserOperation:function(){this.showUserOperation=!this.showUserOperation},routerTo:function(t){switch(t){case-1:this.chooseH=!1,this.chooseA=!1,this.chooseC=!1,this.chooseM=!1;break;case 0:this.chooseH=!0,this.chooseA=!1,this.chooseC=!1,this.chooseM=!1;break;case 1:this.chooseH=!1,this.chooseA=!0,this.chooseC=!1,this.chooseM=!1;break;case 2:this.chooseH=!1,this.chooseA=!1,this.chooseC=!0,this.chooseM=!1;break;case 3:this.chooseH=!1,this.chooseA=!1,this.chooseC=!1,this.chooseM=!0;break;default:this.chooseH=!0,this.chooseA=!1,this.chooseC=!1,this.chooseM=!1}},selectWebsite:function(t){(this.chooseH||this.chooseM)&&this.$router.push("/analytics"),this.showSelect=!1,this.selectInfo="当前选择："+t.host,this.$store.commit("setCurrentWebsite",t)}},watch:{chooseH:function(t){t&&(this.selectInfo="全部网站数据")},chooseC:function(t){t&&this.currentWebsite&&(this.selectInfo=this.currentWebsite.host)},chooseA:function(t){t&&this.currentWebsite&&(this.selectInfo=this.currentWebsite.host)},chooseM:function(t){t&&(this.selectInfo="全部网站数据")},currentWebsite:function(t){t&&(this.chooseC||this.chooseA)?this.selectInfo="当前选择："+t.host:this.selectInfo="全部网站数据"}},mounted:function(){var t=this;this.getUser(),this.getWebsites(),window.onbeforeunload=function(){sessionStorage.setItem("website",a()(t.currentWebsite))}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",{attrs:{id:"app"}},[s("el-header",{staticClass:"header"},[s("el-row",{attrs:{type:"flex",justify:"space-between"}},[s("el-col",{staticClass:"header-left",attrs:{span:16}},[s("router-link",{staticClass:"logo",attrs:{to:"/",tag:"div"}}),t._v(" "),s("div",{staticClass:"select",on:{click:t.toggleSelect}},[t._v("\n            "+t._s(t.selectInfo)+" "),s("i",{class:{"el-icon-caret-right":!t.showSelect,"el-icon-caret-left":t.showSelect}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showSelect,expression:"showSelect"}],staticClass:"select-content"},[s("ul",t._l(t.websites,function(e){return s("li",{on:{click:function(s){return t.selectWebsite(e)}}},[t._v(t._s(e.host))])}),0)])],1),t._v(" "),s("el-col",{staticClass:"header-right",attrs:{span:8}},[t.user?s("div",{staticClass:"user"},[s("div",{staticClass:"user-avatar",on:{click:t.toggleUserOperation}},[s("i",{staticClass:"el-icon-user-solid"}),t._v(" "+t._s(t.user.username)+" \n              "),s("i",{class:{"el-icon-caret-bottom":!t.showUserOperation,"el-icon-caret-top":t.showUserOperation}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showUserOperation,expression:"showUserOperation"}],staticClass:"user-operation"},[s("a",{on:{click:t.logout}},[t._v("登出")])])]):s("div",{staticClass:"sign"},[s("router-link",{staticClass:"login",attrs:{to:"/login",tag:"a"}},[t._v("登录")]),t._v(" "),s("router-link",{staticClass:"register",attrs:{to:"/register",tag:"a"}},[t._v("注册")])],1)])],1)],1),t._v(" "),s("el-container",[s("el-aside",{staticClass:"side",attrs:{width:t.asideWidth+"px"}},[s("div",{staticClass:"list-group"},[s("router-link",{staticClass:"list-group-item",class:{choose:t.chooseH},attrs:{to:"/",tag:"div"}},[s("i",{staticClass:"el-icon-s-home",staticStyle:{color:"#4f97e7"}}),t._v(" 主页\n          ")]),t._v(" "),s("router-link",{staticClass:"list-group-item",class:{choose:t.chooseA},attrs:{to:"/analytics",tag:"div"}},[s("i",{staticClass:"el-icon-s-data",staticStyle:{color:"#e7cd5a"}}),t._v(" 分析\n          ")]),t._v(" "),s("router-link",{staticClass:"list-group-item",class:{choose:t.chooseC},attrs:{to:"/custom",tag:"div"}},[s("i",{staticClass:"el-icon-s-check",staticStyle:{color:"#e78271"}}),t._v(" 高级\n          ")]),t._v(" "),s("router-link",{staticClass:"list-group-item",class:{choose:t.chooseM},attrs:{to:"/manage",tag:"div"}},[s("i",{staticClass:"el-icon-setting",staticStyle:{color:"#e76cb2"}}),t._v(" 管理\n          ")])],1)]),t._v(" "),s("el-main",{staticClass:"main"},[s("router-view",{on:{routerTo:t.routerTo,addNotification:t.addNotification}})],1)],1)],1)},staticRenderFns:[]};var l=s("VU/8")(u,h,!1,function(t){s("lJPj")},null,null).exports,f=s("/ocq"),g=s("Y81h"),d=s.n(g);d.a.configure({easing:"ease",speed:500,showSpinner:!1,trickleSpeed:200,minimum:.3});var b=function(){return s.e(1).then(s.bind(null,"lO7g"))},p=function(){return s.e(2).then(s.bind(null,"S5a6"))};n.default.use(f.a);var m=new f.a({mode:"history",base:"analytics-web",routes:[{path:"/",name:"home",component:b},{path:"/analytics",name:"analytics",component:function(){return s.e(0).then(s.bind(null,"msRV"))},meta:{requireAuth:!0}},{path:"/custom",name:"custom",component:p,meta:{requireAuth:!0},children:[{path:":id",component:p,meta:{requireAuth:!0}}]},{path:"/manage",name:"manage",component:function(){return s.e(5).then(s.bind(null,"gsrS"))},meta:{requireAuth:!0}},{path:"/login",name:"login",component:function(){return s.e(4).then(s.bind(null,"xJsL"))}},{path:"/register",name:"register",component:function(){return s.e(3).then(s.bind(null,"dIqY"))}},{path:"*",name:"other",component:b}]});m.beforeEach(function(t,e,s){d.a.start(),localStorage.getItem("token")?["login","register"].indexOf(t.name)>=0?s("/"):s():t.meta.requireAuth?s("/login"):s()}),m.afterEach(function(){d.a.done()});var w=m,v={setUser:function(t,e){t.user=e},clearUser:function(t){t.user=null,t.websites=[],t.currentWebsite=null,localStorage.removeItem("token")},setWebsites:function(t,e){t.websites=e},setCurrentWebsite:function(t,e){t.currentWebsite=e},setVisitor:function(t,e){t.visitor=e}},W=s("//Fk"),C=s.n(W),S=s("mtWM"),k=s.n(S);k.a.defaults.baseURL="https://dev.usemock.com/65f7b4373d6a5fe053f4fbf3",k.a.interceptors.request.use(function(t){return localStorage.getItem("token")&&(t.headers.Authorization="Bearer "+localStorage.getItem("token")),t},function(t){return t}),k.a.interceptors.response.use(function(t){return 2===t.data.status?t.data:"jwt expired"===t.data.message?(U.commit("clearUser"),w.push("/login"),C.a.reject(t.data)):C.a.reject(t.data)},function(t){return C.a.reject(t.response?t.response.data:{message:"内部错误"})});var _={getUser:function(t){var e=t.commit;localStorage.getItem("token")&&k.a.get("/api/users/user").then(function(t){e("setUser",t.user)}).catch(function(){e("clearUser")})},login:function(t,e){var s=t.commit;return new C.a(function(t,n){k.a.post("/api/users/login",e).then(function(e){s("setUser",e.user),localStorage.setItem("token",e.token),t(e)}).catch(function(t){n(t)})})},register:function(t,e){var s=t.commit;return new C.a(function(t,n){k.a.post("/api/users/register",e).then(function(e){s("setUser",e.user),localStorage.setItem("token",e.token),t(e)}).catch(function(t){n(t)})})},validateUsername:function(t,e){return new C.a(function(t,s){k.a.post("/api/users/username",{username:e}).then(function(e){return t(e)}).catch(function(t){return s(t)})})},changePassword:function(t,e){t.commit;return new C.a(function(t,s){k.a.put("/api/users/change/password",e).then(function(e){t(e)}).catch(function(t){s(t)})})},getWebsites:function(t){t.state;var e=t.commit;return new C.a(function(t,s){localStorage.getItem("token")?k.a.get("/api/websites/user").then(function(s){e("setWebsites",s.websites),t(s)}).catch(function(t){s(t)}):t([])})},validateSite:function(t,e){return new C.a(function(t,s){k.a.get("/api/websites/website/validate/"+e).then(function(e){t(e)}).catch(function(t){s(t)})})},addWebsite:function(t,e){return new C.a(function(t,s){k.a.post("/api/websites/website",e).then(function(e){t(e)}).catch(function(t){s(t)})})},getWebsite:function(t,e){if(localStorage.getItem("token"))return new C.a(function(t,s){k.a.get("/api/websites/website/"+e).then(function(e){t(e)}).catch(function(t){s(t)})})},getOverview:function(){return new C.a(function(t,e){localStorage.getItem("token")&&k.a.get("/api/websites/overview").then(function(e){return t(e)}).catch(function(t){e(t)})})},getStatistics:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/websites/website/statistics/"+s.currentWebsite.config+"?date="+e).then(function(e){t(e)}).catch(function(t){n(t)})})},getCompareData:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/websites/website/compare/"+s.currentWebsite.config+"?days="+e).then(function(e){t(e)}).catch(function(t){n(t)})})},getLimitRecords:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/websites/website/records/"+s.currentWebsite.config+"?page="+e).then(function(e){t(e)}).catch(function(t){n(t)})})},getRecordsCount:function(t){var e=t.state;return new C.a(function(t,s){e.currentWebsite&&k.a.get("/api/websites/website/records/"+e.currentWebsite.config).then(function(e){t(e)}).catch(function(t){s(t)})})},getRecordMore:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/records/more/"+e).then(function(e){t(e)}).catch(function(t){n(t)})})},getONVisitorData:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/websites/website/novisitor/"+s.currentWebsite.config+"?days="+e).then(function(e){t(e)}).catch(function(t){n(t)})})},getSVisitorData:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/websites/website/svisitor/"+s.currentWebsite.config+"?days="+e).then(function(e){t(e)}).catch(function(t){n(t)})})},getEventData:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/websites/website/event/"+s.currentWebsite.config+"?days="+e).then(function(e){t(e)}).catch(function(t){n(t)})})},getConversionData:function(t,e){var s=t.state;return new C.a(function(t,n){s.currentWebsite&&k.a.get("/api/websites/website/conversion/"+s.currentWebsite.config+"?days="+e).then(function(e){t(e)}).catch(function(t){n(t)})})},editWebsite:function(t,e){t.state;return new C.a(function(t,s){k.a.put("/api/websites/website",e).then(function(e){t(e)}).catch(function(t){s(t)})})},deleteWebsite:function(t,e){t.state;return new C.a(function(t,s){k.a.delete("/api/websites/website/"+e).then(function(e){t(e)}).catch(function(t){s(t)})})}};n.default.use(r.a);var U=new r.a.Store({state:{isLogin:!1,user:null,websites:[],currentWebsite:null,visitor:!1},getters:{},actions:_,mutations:v});n.default.use(o.a),n.default.config.productionTip=!1,new n.default({el:"#app",router:w,store:U,components:{App:l},template:"<App/>"})},ky1F:function(t,e){},lJPj:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.840017414d0ece1db04b.js.map